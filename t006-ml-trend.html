<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>完整趨勢交易系統整合 - 量化交易研究報告</title>
    
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #64748b;
            --accent-color: #f59e0b;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --text-color: #1e293b;
            --bg-color: #f8fafc;
            --card-bg: #ffffff;
            --border-color: #e2e8f0;
            --code-bg: #1e293b;
            --code-text: #e2e8f0;
            --table-header: #f1f5f9;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--bg-color);
            margin: 0;
            padding: 0;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 3rem 2rem;
            border-radius: 16px;
            text-align: center;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }
        
        .header .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 0.5rem;
        }
        
        .header .description {
            font-size: 1rem;
            opacity: 0.8;
        }
        
        .content {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }
        
        .content h1, .content h2, .content h3, .content h4, .content h5, .content h6 {
            color: var(--primary-color);
            margin-top: 2rem;
            margin-bottom: 1rem;
        }
        
        .content h1 { font-size: 2.2rem; }
        .content h2 { font-size: 1.8rem; }
        .content h3 { font-size: 1.5rem; }
        .content h4 { font-size: 1.3rem; }
        .content h5 { font-size: 1.1rem; }
        .content h6 { font-size: 1rem; }
        
        .content p {
            margin-bottom: 1rem;
            line-height: 1.7;
        }
        
        .content ul, .content ol {
            margin-bottom: 1rem;
            padding-left: 2rem;
        }
        
        .content li {
            margin-bottom: 0.5rem;
        }
        
        .content table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .content th, .content td {
            border: 1px solid var(--border-color);
            padding: 0.75rem;
            text-align: left;
        }
        
        .content th {
            background-color: var(--table-header);
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .content tr:nth-child(even) {
            background-color: #f8fafc;
        }
        
        .content blockquote {
            border-left: 4px solid var(--primary-color);
            padding-left: 1rem;
            margin: 1rem 0;
            color: var(--secondary-color);
            font-style: italic;
        }
        
        .content code {
            background-color: #f1f5f9;
            color: var(--primary-color);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.9em;
        }
        
        .content pre {
            background-color: var(--code-bg);
            color: var(--code-text);
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1.5rem 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .content pre code {
            background-color: transparent;
            color: inherit;
            padding: 0;
        }
        
        .back-to-home {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: var(--primary-color);
            color: white;
            text-decoration: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 500;
            margin-bottom: 2rem;
            transition: all 0.3s ease;
        }
        
        .back-to-home:hover {
            background: #1d4ed8;
            transform: translateX(-4px);
        }
        
        .footer {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 12px;
            text-align: center;
            margin-top: 2rem;
            border-top: 1px solid var(--border-color);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .footer p {
            color: var(--secondary-color);
            margin-bottom: 0.5rem;
        }
        
        .footer .disclaimer {
            font-size: 0.875rem;
            font-style: italic;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
        }
        
        .info-box {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-left: 4px solid var(--primary-color);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }
        
        .warning-box {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-left: 4px solid var(--accent-color);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }
        
        .success-box {
            background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
            border-left: 4px solid var(--success-color);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .header {
                padding: 2rem 1rem;
            }
            
            .content {
                padding: 1.5rem;
            }
            
            .content h1 { font-size: 1.8rem; }
            .content h2 { font-size: 1.5rem; }
            .content h3 { font-size: 1.3rem; }
        }
    </style>
    
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-to-home">← 返回研究目錄</a>
        
        <div class="header">
            <h1>完整趨勢交易系統整合</h1>
            <p class="subtitle">量化交易研究報告 - 2026-02-20</p>
            <p class="description">六層系統架構：數據處理 → 策略分析 → 風險管理 → 執行 → 監控 → 優化</p>
        </div>
        
        <div class="content">
            <h1 id="_1">機器學習增強趨勢預測研究<a class="headerlink" href="#_1" title="連結到此標題">&para;</a></h1>
<p><strong>Task ID:</strong> t006-ml-trend
<strong>Agent:</strong> Charlie Research
<strong>Status:</strong> in_progress
<strong>Timestamp:</strong> 2026-02-19T14:20:00+08:00</p>
<h2 id="_2">研究目標<a class="headerlink" href="#_2" title="連結到此標題">&para;</a></h2>
<p>使用機器學習（LSTM/Transformer）預測趨勢，發現非線性模式，提高預測準確性。</p>
<h2 id="_3">核心概念<a class="headerlink" href="#_3" title="連結到此標題">&para;</a></h2>
<h3 id="_4">為什麼需要機器學習？<a class="headerlink" href="#_4" title="連結到此標題">&para;</a></h3>
<p>傳統技術指標的局限：
- 靜態參數，無法適應市場變化
- 線性假設，無法捕捉非線性模式
- 滯後性，對市場變化反應慢
- 信號噪音比低，容易產生假信號</p>
<p><strong>機器學習的優勢：</strong>
- 自動特徵學習
- 非線性模式識別
- 時序依賴建模
- 動態適應市場變化</p>
<h2 id="_5">機器學習方法<a class="headerlink" href="#_5" title="連結到此標題">&para;</a></h2>
<h3 id="1-lstmlong-short-term-memory">1. LSTM（Long Short-Term Memory）<a class="headerlink" href="#1-lstmlong-short-term-memory" title="連結到此標題">&para;</a></h3>
<p><strong>特點：</strong>
- 專門設計處理時序數據
- 可以捕捉長期依賴
- 適合序列預測</p>
<p><strong>優點：</strong>
- 對趨勢有較好的捕捉能力
- 訓練相對簡單
- 解釋性較好（可視化權重）</p>
<p><strong>缺點：</strong>
- 梯度消失問題
- 訓練時間較長
- 對突然變化的適應性有限</p>
<h3 id="2-transformer">2. Transformer（自注意力機制）<a class="headerlink" href="#2-transformer" title="連結到此標題">&para;</a></h3>
<p><strong>特點：</strong>
- 自注意力機制捕捉長距離依賴
- 並行處理，訓練速度快
- 可以處理多個時間尺度</p>
<p><strong>優點：</strong>
- 強大的表示能力
- 可解釋注意力權重
- 適合多變量預測</p>
<p><strong>缺點：</strong>
- 需要大量數據
- 過擬合風險高
- 超參數調整複雜</p>
<h3 id="3">3. 混合模型<a class="headerlink" href="#3" title="連結到此標題">&para;</a></h3>
<p><strong>結構：</strong></p>
<pre><code>CNN-LSTM: CNN 提取特徵 + LSTM 建模時序
Transformer-LSTM: 注意力機制 + 記憶單元
</code></pre>
<p><strong>優點：</strong>
- 結合不同方法的優勢
- 提高預測精度
- 降低單一模型的風險</p>
<h2 id="_6">特徵工程<a class="headerlink" href="#_6" title="連結到此標題">&para;</a></h2>
<h3 id="_7">價格相關特徵<a class="headerlink" href="#_7" title="連結到此標題">&para;</a></h3>
<pre><code class="language-python">def calculate_price_features(data):
    &quot;&quot;&quot;
    計算價格相關特徵

    Parameters:
    -----------
    data : pd.DataFrame
        OHLCV 數據

    Returns:
    --------
    pd.DataFrame
        特徵數據
    &quot;&quot;&quot;
    features = pd.DataFrame()

    # 基礎價格特徵
    features['returns'] = data['close'].pct_change()
    features['log_returns'] = np.log(data['close'] / data['close'].shift(1))

    # 滾動統計
    for window in [5, 10, 20, 50]:
        features[f'close_ma_{window}'] = data['close'].rolling(window=window).mean()
        features[f'close_std_{window}'] = data['close'].rolling(window=window).std()
        features[f'returns_std_{window}'] = features['returns'].rolling(window=window).std()

    # 價格位置
    features['price_high_20'] = data['close'] / data['close'].rolling(20).max()
    features['price_low_20'] = data['close'] / data['close'].rolling(20).min()

    return features
</code></pre>
<h3 id="_8">技術指標特徵<a class="headerlink" href="#_8" title="連結到此標題">&para;</a></h3>
<pre><code class="language-python">def calculate_technical_features(data):
    &quot;&quot;&quot;
    計算技術指標特徵

    Parameters:
    -----------
    data : pd.DataFrame
        OHLCV 數據

    Returns:
    --------
    pd.DataFrame
        技術指標特徵
    &quot;&quot;&quot;
    import talib

    features = pd.DataFrame()

    # ADX - 趨勢強度
    features['adx'] = talib.ADX(data['high'], data['low'], data['close'])

    # MACD
    macd, macdsignal, macdhist = talib.MACD(data['close'])
    features['macd'] = macd
    features['macd_signal'] = macdsignal
    features['macd_hist'] = macdhist

    # RSI
    features['rsi'] = talib.RSI(data['close'])

    # ATR
    features['atr'] = talib.ATR(data['high'], data['low'], data['close'])

    return features
</code></pre>
<h3 id="_9">市場狀態特徵<a class="headerlink" href="#_9" title="連結到此標題">&para;</a></h3>
<pre><code class="language-python">def calculate_market_state_features(data):
    &quot;&quot;&quot;
    計算市場狀態特徵

    Parameters:
    -----------
    data : pd.DataFrame
        OHLCV 數據

    Returns:
    --------
    pd.DataFrame
        市場狀態特徵
    &quot;&quot;&quot;
    features = pd.DataFrame()

    # 波動率分類
    volatility = data['close'].pct_change().rolling(20).std()
    features['volatility_regime'] = pd.cut(
        volatility,
        bins=[0, 0.005, 0.01, 0.02, 0.035, float('inf')],
        labels=['extreme_low', 'low', 'medium', 'high', 'extreme_high']
    )

    # 趨勢狀態
    ma_short = data['close'].rolling(20).mean()
    ma_long = data['close'].rolling(60).mean()
    features['trend_regime'] = np.where(ma_short &gt; ma_long, 1, 0)

    return features
</code></pre>
<h2 id="_10">模型架構<a class="headerlink" href="#_10" title="連結到此標題">&para;</a></h2>
<h3 id="lstm">LSTM 模型<a class="headerlink" href="#lstm" title="連結到此標題">&para;</a></h3>
<pre><code class="language-python">class LSTMModel(nn.Module):
    &quot;&quot;&quot;
    LSTM 時序預測模型
    &quot;&quot;&quot;

    def __init__(self, input_size, hidden_size, num_layers, output_size):
        &quot;&quot;&quot;
        初始化 LSTM 模型

        Parameters:
        -----------
        input_size : int
            輸入特徵維度
        hidden_size : int
            LSTM 隱藏層大小
        num_layers : int
            LSTM 層數
        output_size : int
            輸出大小（1 = 漲/跌，3 = 漲/平/跌）
        &quot;&quot;&quot;
        super(LSTMModel, self).__init__()
        self.hidden_size = hidden_size
        self.num_layers = num_layers

        self.lstm = nn.LSTM(
            input_size,
            hidden_size,
            num_layers,
            batch_first=True,
            dropout=0.2
        )
        self.fc = nn.Linear(hidden_size, output_size)

    def forward(self, x, hidden):
        &quot;&quot;&quot;
        前向傳播
        &quot;&quot;&quot;
        out, hidden = self.lstm(x, hidden)
        out = self.fc(out[:, -1, :])  # 取最後一個時間步
        return out, hidden
</code></pre>
<h3 id="transformer">Transformer 模型<a class="headerlink" href="#transformer" title="連結到此標題">&para;</a></h3>
<pre><code class="language-python">class TransformerModel(nn.Module):
    &quot;&quot;&quot;
    Transformer 時序預測模型
    &quot;&quot;&quot;

    def __init__(self, input_size, d_model, nhead, num_layers, output_size):
        &quot;&quot;&quot;
        初始化 Transformer 模型

        Parameters:
        -----------
        input_size : int
            輸入特徵維度
        d_model : int
            Transformer 模型維度
        nhead : int
            注意力頭數
        num_layers : int
            Transformer 層數
        output_size : int
            輸出大小
        &quot;&quot;&quot;
        super(TransformerModel, self).__init__()
        self.d_model = d_model
        self.embedding = nn.Linear(input_size, d_model)
        self.pos_encoder = PositionalEncoding(d_model)

        encoder_layer = nn.TransformerEncoderLayer(
            d_model=d_model,
            nhead=nhead,
            dim_feedforward=d_model * 4,
            dropout=0.2
        )
        self.transformer_encoder = nn.TransformerEncoder(
            encoder_layer,
            num_layers=num_layers
        )
        self.fc = nn.Linear(d_model, output_size)

    def forward(self, x):
        &quot;&quot;&quot;
        前向傳播
        &quot;&quot;&quot;
        x = self.embedding(x) * np.sqrt(self.d_model)
        x = self.pos_encoder(x)
        x = self.transformer_encoder(x)
        out = self.fc(x[:, 0, :])  # 取 CLS token
        return out
</code></pre>
<h2 id="_11">實作計劃<a class="headerlink" href="#_11" title="連結到此標題">&para;</a></h2>
<h3 id="phase-1">Phase 1: 數據準備<a class="headerlink" href="#phase-1" title="連結到此標題">&para;</a></h3>
<ul>
<li>收集歷史數據</li>
<li>特徵工程</li>
<li>標籤定義（漲/平/跌）</li>
<li>訓練集/驗證集/測試集分割</li>
</ul>
<h3 id="phase-2">Phase 2: 模型訓練<a class="headerlink" href="#phase-2" title="連結到此標題">&para;</a></h3>
<ul>
<li>LSTM 模型訓練</li>
<li>Transformer 模型訓練</li>
<li>超參數優化</li>
</ul>
<h3 id="phase-3">Phase 3: 模型評估<a class="headerlink" href="#phase-3" title="連結到此標題">&para;</a></h3>
<ul>
<li>預測準確率</li>
<li>混淆矩陣</li>
<li>回測績效</li>
</ul>
<h3 id="phase-4">Phase 4: 策略集成<a class="headerlink" href="#phase-4" title="連結到此標題">&para;</a></h3>
<ul>
<li>將 ML 預測與傳統趨勢策略結合</li>
<li>預測置信度加權</li>
<li>動態閾值調整</li>
</ul>
<h2 id="_12">下一步<a class="headerlink" href="#_12" title="連結到此標題">&para;</a></h2>
<p>完成機器學習增強趨勢預測後，趨勢交易研究專案將完成所有 6 個任務。</p>
        </div>
        
        <div class="footer">
            <p>© 2026 Charlie's Quantitative Trading Research Hub</p>
            <p class="disclaimer">⚠️ 免責聲明：研究內容僅供學術參考，不構成任何投資建議。投資有風險，請謹慎評估。</p>
        </div>
    </div>
</body>
</html>
