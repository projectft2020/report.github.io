<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Output</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #007bff;
            padding-bottom: 10px;
        }
        h2 {
            color: #555;
            margin-top: 30px;
        }
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
        }
        pre {
            background: #f4f4f4;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background: #007bff;
            color: white;
        }
        .footer {
            text-align: center;
            margin-top: 40px;
            color: #666;
            font-size: 0.9em;
        }
        .back-link {
            display: inline-block;
            margin-top: 20px;
            color: #007bff;
            text-decoration: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Task Output</h1>
<p><strong>Task ID:</strong> 20260221-1771706799-s140
<strong>Agent:</strong> Charlie Research
<strong>Status:</strong> completed
<strong>Timestamp:</strong> 2026-02-21T21:42:00Z</p>
<h2>Research Summary</h2>
<p>genriesz is a comprehensive Python package for automatic debiased machine learning (DML) that implements Generalized Riesz Regression (GRR) under Bregman divergences. It provides a unified framework for estimating Riesz representers with automatic regressor balancing (ARB) and supports multiple estimators with valid statistical inference.</p>
<h2>Key Findings</h2>
<ol>
<li>
<p><strong>Package Overview</strong> ‚Äî genriesz is an open-source Python package that implements automatic DML and generalized Riesz regression, providing a unified framework for estimating Riesz representers by minimizing empirical Bregman divergences. | Source: <a href="https://arxiv.org/abs/2602.17543">arXiv:2602.17543</a></p>
</li>
<li>
<p><strong>Core Innovation: ARB</strong> ‚Äî A key design principle is Automatic Regressor Balancing (ARB): given a Bregman generator and a representer model class, genriesz automatically constructs a compatible link function so that the generalized Riesz regression estimator satisfies balancing (moment-matching) optimality conditions in a user-chosen basis. | Source: <a href="https://arxiv.org/abs/2602.17543">arXiv:2602.17543</a></p>
</li>
<li>
<p><strong>Unified Framework</strong> ‚Äî The framework includes covariate balancing, nearest-neighbor matching, calibrated estimation, and density ratio estimation as special cases, all unified under Bregman divergence minimization. | Source: <a href="https://github.com/MasaKat0/genriesz">GitHub Repository</a></p>
</li>
<li>
<p><strong>Multiple Estimators</strong> ‚Äî The package provides four main estimators: Regression Adjustment (RA), Riesz Weighting (RW), Augmented Riesz Weighting (ARW), and TMLE-style estimators, all with cross-fitting, confidence intervals, and p-values. | Source: <a href="https://arxiv.org/abs/2602.17543">arXiv:2602.17543</a></p>
</li>
<li>
<p><strong>Availability and Installation</strong> ‚Äî The package is available on PyPI (<code>pip install genriesz</code>) and GitHub, with optional extras for scikit-learn and PyTorch integrations. It requires Python &gt;= 3.10 and has core dependencies on NumPy and SciPy. | Source: <a href="https://github.com/MasaKat0/genriesz">GitHub Repository</a></p>
</li>
</ol>
<h2>Detailed Analysis</h2>
<h3>Technical Foundation</h3>
<p>genriesz is built on the mathematical foundation of Riesz representation theorem and debiased machine learning. The core idea is to estimate linear functionals of the form Œ∏‚ÇÄ = ùîº[m(W, Œ≥‚ÇÄ)] where W = (X, Y) contains regressors and outcomes, and Œ≥‚ÇÄ(x) = ùîº[Y|X=x] is the unknown regression function.</p>
<p>The package implements Generalized Riesz Regression which estimates Riesz representers Œ±‚ÇÄ by minimizing empirical Bregman-Riesz objectives. This approach unifies various existing methods including:</p>
<ul>
<li><strong>SQ-Riesz regression</strong>: Using squared distance generators</li>
<li><strong>UKL-Riesz regression</strong>: Using unnormalized KL divergence generators  </li>
<li><strong>BKL-Riesz regression</strong>: Using binary KL divergence generators</li>
<li><strong>BP-Riesz regression</strong>: Using Basu's power divergence generators</li>
<li><strong>PU-Riesz regression</strong>: Using PU learning generators</li>
</ul>
<h3>Key Features</h3>
<h4>1. Modular Architecture</h4>
<p>The package provides a modular interface allowing users to specify:
- <strong>Target linear functional</strong> via a black-box evaluation oracle
- <strong>Representer model</strong> via basis functions (polynomial, RKHS approximations, random forest leaf encodings, neural embeddings, nearest-neighbor catchment basis)
- <strong>Bregman generator</strong> with optional user-supplied derivatives</p>
<h4>2. Built-in Estimands</h4>
<p>Convenience wrappers are provided for common causal inference problems:
- <strong>ATE</strong> (Average Treatment Effect): <code>grr_ate</code>
- <strong>ATT</strong> (Average Treatment Effect on Treated): <code>grr_att</code><br />
- <strong>DID</strong> (Difference-in-Differences): <code>grr_did</code>
- <strong>AME</strong> (Average Marginal Effect): <code>grr_ame</code></p>
<h4>3. Basis Functions</h4>
<p>Multiple basis types are supported:
- <strong>Polynomial basis</strong>: For polynomial feature interactions
- <strong>RKHS-style bases</strong>: Random Fourier features and Nystr√∂m approximations
- <strong>kNN catchment basis</strong>: For nearest-neighbor matching
- <strong>Random forest leaves</strong>: Via scikit-learn integration
- <strong>Neural network features</strong>: Via PyTorch integration</p>
<h4>4. Statistical Inference</h4>
<p>The package provides valid inference through:
- Cross-fitting support for high-capacity settings
- Wald-type standard errors from empirical influence function scores
- Confidence intervals and p-values for all estimators
- Asymptotic normality guarantees under standard conditions</p>
<h3>Practical Usage Example</h3>
<pre class="codehilite"><code class="language-python">import numpy as np
from genriesz import (
    grr_ate,
    UKLGenerator,
    PolynomialBasis,
    TreatmentInteractionBasis,
)

# Example data: X = [D, Z] where D is treatment, Z are covariates
n, d_z = 1000, 5
rng = np.random.default_rng(0)
Z = rng.normal(size=(n, d_z))
D = (rng.normal(size=n) &gt; 0).astype(float)
Y = 2.0 * D + Z[:, 0] + rng.normal(size=n)
X = np.column_stack([D, Z])

# Create basis and generator
psi = PolynomialBasis(degree=2)
phi = TreatmentInteractionBasis(base_basis=psi)
gen = UKLGenerator(C=1.0, branch_fn=lambda x: int(x[0] == 1.0)).as_generator()

# Estimate ATE
res = grr_ate(
    X=X, Y=Y,
    basis=phi,
    generator=gen,
    cross_fit=True, folds=5,
    riesz_penalty=&quot;l2&quot;, riesz_lam=1e-3,
    estimators=(&quot;ra&quot;, &quot;rw&quot;, &quot;arw&quot;, &quot;tmle&quot;),
)
print(res.summary_text())
</code></pre>

<h3>Comparison to Related Software</h3>
<p>genriesz complements existing DML libraries like DoubleML and EconML by:
- <strong>Estimand-centric approach</strong>: Users define the functional directly, making it easy to prototype new targets
- <strong>Explicit representer fitting</strong>: Makes the connection between Riesz estimation and balancing weights transparent
- <strong>Unified framework</strong>: Combines methods from density ratio estimation, covariate balancing, and debiased ML</p>
<p>Unlike libraries focused on heterogeneous treatment effects, genriesz specializes in low-dimensional linear functionals with valid inference via orthogonalization.</p>
<h3>Technical Requirements</h3>
<ul>
<li><strong>Python</strong>: &gt;= 3.10</li>
<li><strong>Core dependencies</strong>: NumPy, SciPy</li>
<li><strong>Optional dependencies</strong>: scikit-learn (for tree-based features), PyTorch (for neural features)</li>
<li><strong>License</strong>: GNU General Public License v3.0 (GPL-3.0)</li>
<li><strong>Documentation</strong>: https://genriesz.readthedocs.io/</li>
</ul>
<h2>Sources</h2>
<ul>
<li><a href="https://arxiv.org/abs/2602.17543">genriesz: A Python Package for Automatic Debiased Machine Learning with Generalized Riesz Regression (arXiv:2602.17543)</a> ‚Äî Main paper describing the methodology and package</li>
<li><a href="https://github.com/MasaKat0/genriesz">GitHub Repository: MasaKat0/genriesz</a> ‚Äî Source code, documentation, and examples</li>
<li><a href="https://arxiv.org/abs/2601.07752">A Unified Framework for Debiased Machine Learning: Riesz Representer Fitting under Bregman Divergence (arXiv:2601.07752)</a> ‚Äî Theoretical foundation</li>
</ul>
<h2>Metadata</h2>
<ul>
<li><strong>Confidence:</strong> high</li>
<li><strong>Research depth:</strong> deep</li>
<li><strong>Data freshness:</strong> February 2026 (recent arXiv submission)</li>
<li><strong>Suggestions:</strong> The package appears well-suited for researchers and practitioners working on causal inference and structural parameter estimation who need valid inference for linear functionals</li>
<li><strong>Errors:</strong> None - all sources were successfully accessed and verified</li>
</ul>
        <p class="footer">Generated: 2026-02-22 11:29:11</p>
        <a href="index.html" class="back-link">‚Üê Back to Index</a>
    </div>
</body>
</html>
